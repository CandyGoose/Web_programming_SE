# Лабораторная работа #2
### Номер варианта: _223317_

Интерфейс:

![image](https://github.com/VeraKasianenko/VeraKasianenko/assets/112972833/80f0ac34-6488-460f-bf73-b67f89038a20)

## Внимание! У разных вариантов разный текст задания!

![image](https://github.com/VeraKasianenko/VeraKasianenko/assets/112972833/3149b234-5270-42da-aaaf-2c0652e788c0)

__Изменения данных__
- изменение X: Button {'-5', '-4', '-3', '-2', '-1', '0', '1', '2', '3'}
- изменение Y: Text (-3 … 5)
- Изменение R: Radio {'1', '2', '3', '4', '5'}
- метод HTTP: GET
- список результатов сохранять в Bean-компоненте

Разработать веб-приложение на базе сервлетов и JSP, определяющее попадание точки на координатной плоскости в заданную область.

Приложение должно быть реализовано в соответствии с [шаблоном MVC](https://en.wikipedia.org/wiki/Model–view–controller) и состоять из следующих элементов:
- __ControllerServlet__, определяющий тип запроса, и, в зависимости от того, содержит ли запрос информацию о координатах точки и радиусе, делегирующий его обработку одному из перечисленных ниже компонентов. Все запросы внутри приложения должны передаваться этому сервлету (по методу GET или POST в зависимости от варианта задания), остальные сервлеты с веб-страниц напрямую вызываться не должны.
- __AreaCheckServlet__, осуществляющий проверку попадания точки в область на координатной плоскости и формирующий HTML-страницу с результатами проверки. Должен обрабатывать все запросы, содержащие сведения о координатах точки и радиусе области.
- __Страница JSP__, формирующая HTML-страницу с веб-формой. Должна обрабатывать все запросы, не содержащие сведений о координатах точки и радиусе области.

__Разработанная страница JSP должна содержать:__

1. "Шапку", содержащую ФИО студента, номер группы и номер варианта.
2. Форму, отправляющую данные на сервер.
3. Набор полей для задания координат точки и радиуса области в соответствии с вариантом задания.
4. Сценарий на языке JavaScript, осуществляющий валидацию значений, вводимых пользователем в поля формы.
5. Интерактивный элемент, содержащий изображение области на координатной плоскости (в соответствии с вариантом задания) и реализующий следующую функциональность:
   - Если радиус области установлен, клик курсором мыши по изображению должен обрабатываться JavaScript-функцией, определяющей координаты точки, по которой кликнул пользователь и отправляющей полученные координаты на сервер для проверки факта попадания.
   - В противном случае, после клика по картинке должно выводиться сообщение о невозможности определения координат точки.
   - После проверки факта попадания точки в область изображение должно быть обновлено с учётом результатов этой проверки (т.е., на нём должна появиться новая точка).
6. Таблицу с результатами предыдущих проверок. Список результатов должен браться из контекста приложения, HTTP-сессии или Bean-компонента в зависимости от варианта.

__Страница, возвращаемая AreaCheckServlet, должна содержать:__
1. Таблицу, содержащую полученные параметры.
2. Результат вычислений - факт попадания или непопадания точки в область.
3. Ссылку на страницу с веб-формой для формирования нового запроса.

Разработанное веб-приложение необходимо развернуть на сервере [WildFly](https://www.wildfly.org/). Сервер должен быть запущен в standalone-конфигурации, порты должны быть настроены в соответствии с выданным portbase, доступ к http listener'у должен быть открыт для всех IP.

__Вопросы к защите лабораторной работы:__
1. Java-сервлеты. Особенности реализации, ключевые методы, преимущества и недостатки относительно CGI и FastCGI.
2. Контейнеры сервлетов. Жизненный цикл сервлета.
3. Диспетчеризация запросов в сервлетах. Фильтры сервлетов.
4. HTTP-сессии - назначение, взаимодействие сервлетов с сессией, способы передачи идентификатора сессии.
5. Контекст сервлета - назначение, способы взаимодействия сервлетов с контекстом.
6. JavaServer Pages. Особенности, преимущества и недостатки по сравнению с сервлетами, область применения.
7. Жизненный цикл JSP.
8. Структура JSP-страницы. Комментарии, директивы, объявления, скриптлеты и выражения.
9. Правила записи Java-кода внутри JSP. Стандартные переменные, доступные в скриптлетах и выражениях.
10. Bean-компоненты и их использование в JSP.
11. Стандартные теги JSP. Использование Expression Language (EL) в JSP.
12. Параметры конфигурации JSP в дескрипторе развёртывания веб-приложения.
13. Шаблоны проектирования и архитектурные шаблоны. Использование в веб-приложениях.
14. Архитектура веб-приложений. Шаблон MVC. Архитектурные модели Model 1 и Model 2 и их реализация на платформе Java EE.

# Локальный запуск
1) Скачайте WildFly с [сайта](https://www.wildfly.org/downloads/) (я использую 21.0.0 Final: Jakarta EE Full & Web Distribution)
2) Разархивируйте и перейдите в папку `standalone/configuration`
3) Откройте `standalone.xml`
4) В конце этого файла измените в строке порт 8080 на порт из `Portbase` гугл-журнала, либо любой другой, который не будет занят кем-то еще (хотя локально можно не менять)
```
<socket-binding name="http" port="${jboss.http.port:8080}"/>
```
Пример:
```
<socket-binding name="http" port="${jboss.http.port:65435}"/>
```
5) Откройте проект
6) Сверху справа раскройте меню -> `Edit Configurations...`
   
![image](https://github.com/VeraKasianenko/Web_programming_SE/assets/112972833/10256807-c144-4840-b266-cdf415d6ddef)

7) Нажмите на `+ -> JBoss/WildFly Server -> Local`

![image](https://github.com/VeraKasianenko/Web_programming_SE/assets/112972833/cad129b3-16ef-4c12-94f8-b1e19219ad23)

8) Нажмите `Configure...` и укажите путь до папки с WildFly

![image](https://github.com/VeraKasianenko/Web_programming_SE/assets/112972833/9d31c452-7898-4dbb-b9a5-2dc883ca09fa)

![image](https://github.com/VeraKasianenko/Web_programming_SE/assets/112972833/a33aaf7a-d8e0-43ad-b0f5-9dd33c24cb46)

9) Внизу нажмите на кнопку `Fix` и выберете `war exploded`

![image](https://github.com/VeraKasianenko/Web_programming_SE/assets/112972833/2967950e-8a00-4c83-a10d-3b901a5dd821)

![image](https://github.com/VeraKasianenko/Web_programming_SE/assets/112972833/f560c25a-14f2-4daa-b4f1-f6d7afb62daf)

10) Теперь можно нажать `Apply` и запустить WildFly по зеленой кнопке

![image](https://github.com/VeraKasianenko/Web_programming_SE/assets/112972833/5e2ffe2c-efc9-44cb-b4b7-1e9e9fa9b4ca)

# Деплой 2 лабы на Helios

1) Скачайте WildFly с [сайта](https://www.wildfly.org/downloads/) (я использую 21.0.0 Final: Jakarta EE Full & Web Distribution)
2) Закиньте его на гелиос
```
scp -P 2222 wildfly-21.0.0.Final.zip sXXXXXX@helios.cs.ifmo.ru:~/
```
3) Подключитесь к гелиосу и распакуйте его (лучше закидывать именно зипку, а не распакованную папку, потому что очень часто при перекидывании папки теряются файлы и WildFly не запускается)
```
unzip wildfly-21.0.0.Final.zip
```
4)  
- Вариант №1: Перейдите в папку `standalone/configuration` и откройте файл `standalone.xml` для редактирования

```
vi ./standalone/configuration/standalone.xml
```

- Вариант №2: изменить этот файл локально и заменить его на гелиосе.

5) В конце файла поменяйте порт 8080 на порт из `Portbase` гугл-журнала, либо любой другой, который не будет занят кем-то еще
```
<socket-binding name="http" port="${jboss.http.port:8080}"/>
```
Пример:
```
<socket-binding name="http" port="${jboss.http.port:65435}"/>
```
Напоминание как редактировать в vim: чтобы начать редактировать нажмите `i`, чтобы сохранить файл и выйти из редактора, надо нажать `Esc` и набрать `:wq` (иногда требуется поставить `!` в конце). Если вы хотите выйти без сохранения наберите `:q!`

__Наш сервер готов, если все верно, то до 3 лабы ничего менять больше не надо__ 

6) Делаем war архив лабы, для этого в idea ищем сверху `Build -> Build Artifacts... -> All Artifacts -> Build`

![image](https://github.com/VeraKasianenko/VeraKasianenko/assets/112972833/394dfa7d-efdd-4e5a-9077-04b93476df30)

![image](https://github.com/VeraKasianenko/VeraKasianenko/assets/112972833/76560f3e-b15d-48c2-bea8-a0d4af731ca3)

7) После этого в папке `target` будет лежать наш war архив, который мы тоже закидываем на гелиос

![image](https://github.com/VeraKasianenko/VeraKasianenko/assets/112972833/682335a1-838d-4971-a1a2-547a4c82a3f7)

```
scp -P 2222 ./target/lab2-1.0-SNAPSHOT.war sXXXXXX@helios.cs.ifmo.ru:~/
```

8) Подключаемся к гелиосу, сразу пробрасывая порт, который вы указали в пункте 5
```
ssh -L <local-port>:localhost:<helios-port> s368283@helios.cs.ifmo.ru -p 2222
```
Пример:
```
ssh -L 8080:localhost:65435 s368283@helios.cs.ifmo.ru -p 2222
```
9) Переместим war архив в `wildfly-21.0.0.Final/standalone/deployments/`
```
mv lab2-1.0-SNAPSHOT.war wildfly-21.0.0.Final/standalone/deployments/
```
_Примечание._ Я бы не рекомендовала закидывать war через административную консоль, потому что если надо будет обновить war, то сделать это получится только через сайт, для которого надо запускать ./wildfly-21.0.0.Final/bin/add-user.sh (только один раз), менять еще один порт из 5 пункта (8090), пробрасывать его каждый раз для того чтобы использовать сайт, короче оно вам не надо.
10) Теперь мы можем запустить лабу командой:
```
./wildfly-21.0.0.Final/bin/standalone.sh
```
11) Отрываем браузер по ссылке [http://localhost:8080/lab2-1.0-SNAPSHOT/](http://localhost:8080/lab2-1.0-SNAPSHOT/), радуемся 

_Примечание._ Чтобы заменить war, надо сначала перейти в `wildfly-21.0.0.Final/standalone/deployments/` и удалить сам .war и .war.deployed, а затем закинуть новый.